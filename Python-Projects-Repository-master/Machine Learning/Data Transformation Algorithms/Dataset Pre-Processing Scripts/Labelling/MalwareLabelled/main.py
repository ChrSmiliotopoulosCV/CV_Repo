# MalwareLabelled pcap file, network traffic labelling with Python.
# Importing Libraries
import pandas as pd
import sklearn

# Importing the Dataset
# Read data from CSV file into pandas dataframe

data = pd.read_csv((r"C:\Users\chrsm\Desktop\csv files\Malware.csv"), encoding="ISO-8859-1", low_memory=False)
data.head()

# for loop to add a conditional label in order to label the dataset's rows based on the conditions as "Malware" or
# "normal" traffic

for index, row in data.iterrows():
    if (1021326 <= row['Frame Number'] <= 2310931) and ((row['IPv4 Address'] == '192.168.2.248')
                                                        or (row['IPv4 Address'] == '192.168.2.42')
                                                        or (row['IPv4 Address'] == '192.168.2.73')
                                                        or (row['IPv4 Address'] == '192.168.2.41')
                                                        or (row['IPv4 Address'] == '192.168.2.254')
                                                        or (row['IPv4 Address'] == '192.168.2.184')
                                                        or (row['IPv4 Address'] == '192.168.2.190')
                                                        or (row['IPv4 Address'] == '192.168.2.130')):
        data.loc[index, 'labelling'] = "Malware"
    else:
        data.loc[index, 'labelling'] = "normal"

data.to_csv(r"C:\Users\chrsm\Desktop\csv files\Malware_Labelled.csv")
